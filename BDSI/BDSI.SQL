
-- Tabela USUARIO
CREATE TABLE USUARIO (
    Cpf CHAR(11) NOT NULL,
    Pnome VARCHAR(80) NOT NULL,
    Unome VARCHAR(80) NOT NULL,
    Dt_Nascimento DATE NOT NULL,
    EMAIL VARCHAR(80) NOT NULL,
    Senha CHAR(32) NOT NULL,
    Valor DOUBLE PRECISION DEFAULT 0
);

-- Tabela CARTEIRA
--CREATE TABLE CARTEIRA(
--    Id INTEGER NOT NULL,
--    Valor DOUBLE PRECISION NOT NULL DEFAULT 0,
--    Usuario VARCHAR(11) NOT NULL
--);

-- Tabela METODOPAGAMENTO
--CREATE TABLE METODOPAGAMENTO(
--    Id INTEGER NOT NULL,
--    Carteira INTEGER NOT NULL,
--    TipoPgmt VARCHAR(100) NOT NULL
--);

-- Tabela INVESTIMENTO
--CREATE TABLE INVESTIMENTO(
--    Id INTEGER NOT NULL,
--    Usuario VARCHAR(11) NOT NULL,
--    Tipo VARCHAR(20) NOT NULL,
--    Valor DOUBLE PRECISION NOT NULL,
--   Nmr_Transacao INTEGER NOT NULL,
--    Dt_Transacao DATE NOT NULL 
--);

-- Nova Tabela INVESTIMENTO
CREATE TABLE INVESTIMENTO (
    Id INTEGER NOT NULL,
    Tipo CHAR(15) NOT NULL,
    Valor DOUBLE PRECISION NOT NULL
);

-- Tabela FAZ
CREATE TABLE FAZ (
    Investimento INTEGER NOT NULL,
    Usuario CHAR(11) NOT NULL,
    Nmr_Transacao INTEGER NOT NULL,
    Dt_Transacao DATE NOT NULL,
    Qnt_adquirida DOUBLE PRECISION NOT NULL
);

-- Constraints

ALTER TABLE USUARIO ADD CONSTRAINT PK_USUARIO PRIMARY KEY (Cpf);
--ALTER TABLE CARTEIRA ADD CONSTRAINT PK_CARTEIRA PRIMARY KEY (Id);
--ALTER TABLE METODOPAGAMENTO ADD CONSTRAINT PK_METODOPAGAMENTO PRIMARY KEY (Id, Carteira);
ALTER TABLE INVESTIMENTO ADD CONSTRAINT PK_INVESTIMENTO PRIMARY KEY (Id);
ALTER TABLE FAZ ADD CONSTRAINT PK_FAZ PRIMARY KEY (Investimento, Usuario);
--ALTER TABLE CARTEIRA ADD CONSTRAINT FK_CARTEIRA_USUARIO FOREIGN KEY (Usuario) REFERENCES USUARIO (Cpf) ON DELETE RESTRICT ON UPDATE CASCADE;
--ALTER TABLE INVESTIMENTO ADD CONSTRAINT FK_INVESTIMENTO_USUARIO FOREIGN KEY (Usuario) REFERENCES USUARIO (Cpf) ON DELETE RESTRICT ON UPDATE CASCADE;
--ALTER TABLE METODOPAGAMENTO ADD CONSTRAINT FK_METODOPAGAMENTO_CARTEIRA FOREIGN KEY (Carteira) REFERENCES CARTEIRA (Id) ON DELETE RESTRICT ON UPDATE CASCADE;
ALTER TABLE FAZ ADD CONSTRAINT FK_FAZ_USUARIO FOREIGN KEY (Usuario) REFERENCES USUARIO (Cpf) ON DELETE RESTRICT ON UPDATE CASCADE;
ALTER TABLE FAZ ADD CONSTRAINT FK_FAZ_INVESTIMENTO FOREIGN KEY (Investimento) REFERENCES INVESTIMENTO (Id) ON DELETE RESTRICT ON UPDATE CASCADE;
